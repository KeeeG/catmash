<!DOCTYPE html>
<html>
	<head>
		<link rel="stylesheet" type="text/css" href="style.css">
		<script src="https://code.jquery.com/jquery-3.5.0.js"></script>
		<script type="text/javascript">
		const url='https://22ygqfaki5.execute-api.us-east-1.amazonaws.com/default/getAllVotes';
		var req = new XMLHttpRequest();
		req.responseType = 'json';
		req.open('GET', url, true);
		req.onload  = function() {
		var jsonResponse = req.response;
		// do something with jsonResponse
			for (var i = req.response.CatsElections.length - 1; i >= 0; i--){
			var table = document.getElementById("table");
			var row = table.insertRow(0);
			var cell1 = row.insertCell(0);
			var cell2 = row.insertCell(1);
			var cell3 = row.insertCell(2);
			cell1.innerHTML = req.response.CatsElections[i].cat_id;
			cell2.innerHTML="<img src='"+req.response.CatsElections[i].url+"' width='400px' height='150px'>";
			cell3.innerHTML = "<button type='button' onclick=vote('"+req.response.CatsElections[i].cat_id+"')>You think I am cute ?!</button>";
		}
		};
		req.send(null);
		function vote(id){
			var xmlhttp = new XMLHttpRequest();   // new HttpRequest instance
			var theUrl = "https://22ygqfaki5.execute-api.us-east-1.amazonaws.com/default/getAllVotes";
			xmlhttp.open("POST", theUrl);
			xmlhttp.setRequestHeader("Content-Type", "application/json;charset=UTF-8");
			xmlhttp.send(JSON.stringify({ "cat_id": id }));
			alert("Voted for :" + id);
		}
		</script>
	</head>
	<body>
		<a href="results.html">See results</a>
		<div class="table-users">
			<div class="header">Users</div>
			<table cellspacing="0" id="table">
				<tr>
					<th>Cat ID</th>
					<th>Votes</th>
					<th>Pic !</th>
				</tr>
			</body>
		</html>